{"version":3,"sources":["../src/programmers/internal/application_v31_alias.ts","../src/programmers/internal/application_v31_schema.ts","../src/programmers/internal/application_v31_object.ts"],"names":["application_v31_alias","blockNever","components","alias","value","size","objects","length","application_v31_object","$ref","name","schemas","undefined","schema","application_v31_schema","deprecated","jsDocTags","some","tag","title","info","find","text","CommentFactory","merge","description","Object","assign","attribute","meta","any","type","union","insert","push","nullable","escaped","application_escaped","forEach","templates","AtomicPredicator","template","application_templates","constant","constants","TypeError","NO_BIGINT","application_v31_constant","map","a","atomics","application_boolean","application_number","application_string","array","arrays","application_array","tuple","tuples","application_v31_tuple","native","natives","toLowerCase","MetadataAtomic","create","tags","application_v31_native","sets","maps","obj","aliases","oneOf","_Is_literal","create_object_schema","key","object","properties","extraMeta","patternProperties","additionalProperties","required","property","functional","isRequired","getSoleLiteral","index","indexOf","top","substring","trim","endsWith","pattern","metadata_to_pattern","PatternUtil","STRING","join","extra","elements","values","reduce","x","y","Metadata"],"mappings":"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","sourcesContent":["import { OpenApi } from \"@samchon/openapi\";\n\nimport { CommentFactory } from \"../../factories/CommentFactory\";\n\nimport { IJsDocTagInfo } from \"../../schemas/metadata/IJsDocTagInfo\";\nimport { MetadataAlias } from \"../../schemas/metadata/MetadataAlias\";\n\nimport { application_v31_object } from \"./application_v31_object\";\nimport { application_v31_schema } from \"./application_v31_schema\";\n\n/**\n * @internal\n */\nexport const application_v31_alias =\n  <BlockNever extends boolean>(blockNever: BlockNever) =>\n  (components: OpenApi.IComponents) =>\n  (alias: MetadataAlias): OpenApi.IJsonSchema.IReference => {\n    if (alias.value.size() === 1 && alias.value.objects.length === 1)\n      return application_v31_object(components)(\n        alias.value.objects[0]!,\n      ) as OpenApi.IJsonSchema.IReference;\n\n    const $ref: string = `#/components/schemas/${alias.name}`;\n    if (components.schemas?.[alias.name] === undefined) {\n      // TEMPORARY ASSIGNMENT\n      components.schemas ??= {};\n      components.schemas[alias.name] = {};\n\n      // GENERATE SCHEMA\n      const schema: OpenApi.IJsonSchema | null = application_v31_schema(\n        blockNever,\n      )(components)({\n        deprecated:\n          alias.jsDocTags.some((tag) => tag.name === \"deprecated\") || undefined,\n        title: (() => {\n          const info: IJsDocTagInfo | undefined = alias.jsDocTags.find(\n            (tag) => tag.name === \"title\",\n          );\n          return info?.text?.length\n            ? CommentFactory.merge(info.text)\n            : undefined;\n        })(),\n        description: alias.description ?? undefined,\n      })(alias.value);\n      if (schema !== null)\n        Object.assign(components.schemas[alias.name]!, schema);\n    }\n    return { $ref };\n  };\n","import { OpenApi } from \"@samchon/openapi\";\n\nimport { Metadata } from \"../../schemas/metadata/Metadata\";\nimport { MetadataAtomic } from \"../../schemas/metadata/MetadataAtomic\";\n\nimport { AtomicPredicator } from \"../helpers/AtomicPredicator\";\nimport { application_array } from \"./application_array\";\nimport { application_boolean } from \"./application_boolean\";\nimport { application_escaped } from \"./application_escaped\";\nimport { application_number } from \"./application_number\";\nimport { application_string } from \"./application_string\";\nimport { application_templates } from \"./application_templates\";\nimport { application_v31_alias } from \"./application_v31_alias\";\nimport { application_v31_constant } from \"./application_v31_constant\";\nimport { application_v31_native } from \"./application_v31_native\";\nimport { application_v31_object } from \"./application_v31_object\";\nimport { application_v31_tuple } from \"./application_v31_tuple\";\n\n/**\n * @internal\n */\nexport const application_v31_schema =\n  <BlockNever extends boolean>(blockNever: BlockNever) =>\n  (components: OpenApi.IComponents) =>\n  (attribute: OpenApi.IJsonSchema.__IAttribute) =>\n  (\n    meta: Metadata,\n  ): BlockNever extends true\n    ? OpenApi.IJsonSchema | null\n    : OpenApi.IJsonSchema => {\n    if (meta.any === true)\n      return {\n        ...attribute,\n        type: undefined,\n      };\n\n    //----\n    // GATHER UNION SCHEMAS\n    //----\n    const union: OpenApi.IJsonSchema[] = [];\n    const insert = (schema: OpenApi.IJsonSchema) => union.push(schema);\n\n    // NULLABLE\n    if (meta.nullable === true)\n      insert({\n        type: \"null\",\n      });\n\n    // toJSON() METHOD\n    if (meta.escaped !== null)\n      application_escaped(application_v31_schema(false)(components)({}))(\n        meta.escaped,\n      ).forEach(insert);\n\n    // ATOMIC TYPES\n    if (meta.templates.length && AtomicPredicator.template(meta))\n      insert(application_templates(meta));\n    for (const constant of meta.constants)\n      if (constant.type === \"bigint\") throw new TypeError(NO_BIGINT);\n      else if (AtomicPredicator.constant(meta)(constant.type) === false)\n        continue;\n      else application_v31_constant(constant).map(insert);\n    for (const a of meta.atomics)\n      if (a.type === \"bigint\") throw new TypeError(NO_BIGINT);\n      else if (a.type === \"boolean\") application_boolean(a).forEach(insert);\n      else if (a.type === \"number\") application_number(a).forEach(insert);\n      else if (a.type === \"string\") application_string(a).forEach(insert);\n\n    // ARRAY\n    for (const array of meta.arrays)\n      application_array(application_v31_schema(false)(components)({}))(\n        array,\n      ).forEach(insert);\n\n    // TUPLE\n    for (const tuple of meta.tuples)\n      insert(\n        application_v31_tuple(application_v31_schema(false)(components)({}))(\n          tuple,\n        ),\n      );\n\n    // NATIVES\n    for (const native of meta.natives)\n      if (AtomicPredicator.native(native)) {\n        const type: string = native.toLowerCase();\n        if (meta.atomics.some((a) => a.type === type)) continue;\n        else if (type === \"bigint\") throw new TypeError(NO_BIGINT);\n        else if (type === \"boolean\")\n          insert(\n            application_boolean(\n              MetadataAtomic.create({\n                type: \"boolean\",\n                tags: [],\n              }),\n            )[0]!,\n          );\n        else if (type === \"number\")\n          insert(\n            application_number(\n              MetadataAtomic.create({\n                type: \"number\",\n                tags: [],\n              }),\n            )[0]!,\n          );\n        else if (type === \"string\")\n          insert(\n            application_string(\n              MetadataAtomic.create({\n                type: \"string\",\n                tags: [],\n              }),\n            )[0]!,\n          );\n      } else insert(application_v31_native(components)(native));\n    if (meta.sets.length) insert(application_v31_native(components)(`Set`));\n    if (meta.maps.length) insert(application_v31_native(components)(`Map`));\n\n    // OBJECT\n    for (const obj of meta.objects)\n      insert(application_v31_object(components)(obj));\n\n    // ALIASES\n    for (const alias of meta.aliases)\n      insert(application_v31_alias(blockNever)(components)(alias));\n\n    //----\n    // RETURNS\n    //----\n    if (union.length === 0 && blockNever === true) return null!;\n    const schema: OpenApi.IJsonSchema =\n      union.length === 0\n        ? { type: undefined }\n        : union.length === 1\n          ? union[0]!\n          : { oneOf: union };\n    return {\n      ...schema,\n      ...attribute,\n      title: attribute.title ?? schema.title,\n      description: attribute.description ?? schema.description,\n      deprecated: attribute.deprecated ?? schema.deprecated,\n    };\n  };\n\n/**\n * @internal\n */\nconst NO_BIGINT = \"Error on typia.application(): does not allow bigint type.\";\n","import { OpenApi, OpenApiV3 } from \"@samchon/openapi\";\n\nimport { CommentFactory } from \"../../factories/CommentFactory\";\n\nimport { IJsDocTagInfo } from \"../../schemas/metadata/IJsDocTagInfo\";\nimport { Metadata } from \"../../schemas/metadata/Metadata\";\nimport { MetadataObject } from \"../../schemas/metadata/MetadataObject\";\n\nimport { PatternUtil } from \"../../utils/PatternUtil\";\n\nimport { application_v31_schema } from \"./application_v31_schema\";\nimport { metadata_to_pattern } from \"./metadata_to_pattern\";\n\n/**\n * @internal\n */\nexport const application_v31_object =\n  (components: OpenApi.IComponents) =>\n  (\n    obj: MetadataObject,\n  ): OpenApi.IJsonSchema.IReference | OpenApi.IJsonSchema.IObject => {\n    if (obj._Is_literal() === true)\n      return create_object_schema(components)(obj);\n\n    const key: string = obj.name;\n    const $ref: string = `#/components/schemas/${key}`;\n    if (components.schemas?.[key] !== undefined) return { $ref };\n\n    const object: OpenApiV3.IJsonSchema = {};\n    components.schemas ??= {};\n    components.schemas[key] = object;\n    Object.assign(object, create_object_schema(components)(obj));\n    return { $ref };\n  };\n\n/**\n * @internal\n */\nconst create_object_schema =\n  (components: OpenApi.IComponents) =>\n  (obj: MetadataObject): OpenApi.IJsonSchema.IObject => {\n    // ITERATE PROPERTIES\n    const properties: Record<string, any> = {};\n    const extraMeta: ISuperfluous = {\n      patternProperties: {},\n      additionalProperties: undefined,\n    };\n    const required: string[] = [];\n\n    for (const property of obj.properties) {\n      if (\n        // FUNCTIONAL TYPE\n        property.value.functional === true &&\n        property.value.nullable === false &&\n        property.value.isRequired() === true &&\n        property.value.size() === 0\n      )\n        continue;\n      else if (property.jsDocTags.find((tag) => tag.name === \"hidden\"))\n        continue; // THE HIDDEN TAG\n\n      const key: string | null = property.key.getSoleLiteral();\n      const schema: OpenApi.IJsonSchema | null = application_v31_schema(true)(\n        components,\n      )({\n        deprecated:\n          property.jsDocTags.some((tag) => tag.name === \"deprecated\") ||\n          undefined,\n        title: (() => {\n          const info: IJsDocTagInfo | undefined = property.jsDocTags.find(\n            (tag) => tag.name === \"title\",\n          );\n          if (info?.text?.length) return CommentFactory.merge(info.text);\n          else if (!property.description?.length) return undefined;\n\n          const index: number = property.description.indexOf(\"\\n\");\n          const top: string = (\n            index === -1\n              ? property.description\n              : property.description.substring(0, index)\n          ).trim();\n          return top.endsWith(\".\")\n            ? top.substring(0, top.length - 1)\n            : undefined;\n        })(),\n        description: property.description ?? undefined,\n      })(property.value);\n\n      if (schema === null) continue;\n      if (key !== null) {\n        properties[key] = schema;\n        if (property.value.isRequired() === true) required.push(key);\n      } else {\n        const pattern: string = metadata_to_pattern(true)(property.key);\n        if (pattern === PatternUtil.STRING)\n          extraMeta.additionalProperties = [property.value, schema];\n        else extraMeta.patternProperties[pattern] = [property.value, schema];\n      }\n    }\n\n    return {\n      type: \"object\",\n      properties,\n      required: required.length ? required : undefined,\n      title: (() => {\n        const info: IJsDocTagInfo | undefined = obj.jsDocTags.find(\n          (tag) => tag.name === \"title\",\n        );\n        return info?.text?.length ? CommentFactory.merge(info.text) : undefined;\n      })(),\n      description: obj.description,\n      additionalProperties: join(components)(extraMeta),\n    };\n  };\n\n/**\n * @internal\n */\nconst join =\n  (components: OpenApi.IComponents) =>\n  (extra: ISuperfluous): OpenApi.IJsonSchema | undefined => {\n    // LIST UP METADATA\n    const elements: [Metadata, OpenApi.IJsonSchema][] = Object.values(\n      extra.patternProperties || {},\n    );\n    if (extra.additionalProperties) elements.push(extra.additionalProperties);\n\n    // SHORT RETURN\n    if (elements.length === 0) return undefined;\n    else if (elements.length === 1) return elements[0]![1]!;\n\n    // MERGE METADATA AND GENERATE VULNERABLE SCHEMA\n    const meta: Metadata = elements\n      .map((tuple) => tuple[0])\n      .reduce((x, y) => Metadata.merge(x, y));\n    return application_v31_schema(true)(components)({})(meta) ?? undefined;\n  };\n\n/**\n * @internal\n */\ninterface ISuperfluous {\n  additionalProperties?: undefined | [Metadata, OpenApi.IJsonSchema];\n  patternProperties: Record<string, [Metadata, OpenApi.IJsonSchema]>;\n}\n"]}